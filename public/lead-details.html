<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lead Details</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 min-h-screen p-8">

  <div class="max-w-3xl mx-auto bg-white p-8 rounded shadow">
    <h1 class="text-3xl font-bold mb-6 text-gray-800">Lead Details</h1>

    <dl class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6 text-gray-700">
      <div>
        <dt class="font-semibold">First Name</dt>
        <dd id="firstName" class="mt-1 text-lg"></dd>
      </div>
      <div>
        <dt class="font-semibold">Last Name</dt>
        <dd id="lastName" class="mt-1 text-lg"></dd>
      </div>
      <div>
        <dt class="font-semibold">Email</dt>
        <dd id="email" class="mt-1 text-lg"></dd>
      </div>
      <div>
        <dt class="font-semibold">Phone</dt>
        <dd id="phone" class="mt-1 text-lg"></dd>
      </div>
      <div>
        <dt class="font-semibold">Tort Type</dt>
        <dd id="tortType" class="mt-1 text-lg"></dd>
      </div>
      <div>
        <dt class="font-semibold">Status</dt>
        <dd id="status" class="mt-1 text-lg"></dd>
      </div>
      <div>
        <dt class="font-semibold">Created At</dt>
        <dd id="createdAt" class="mt-1 text-lg"></dd>
      </div>
      <div>
        <dt class="font-semibold">Updated At</dt>
        <dd id="updatedAt" class="mt-1 text-lg"></dd>
      </div>
    </dl>
  </div>

  <script>
    const backendUrl = 'https://crm-backend2-fhi5.onrender.com';

    function getLeadIdFromURL() {
      const params = new URLSearchParams(window.location.search);
      return params.get('id');
    }

    async function fetchLeadById(id) {
      try {
        const res = await fetch(`${backendUrl}/leads/${id}`);
        if (!res.ok) throw new Error('Lead not found');
        return await res.json();
      } catch (err) {
        alert(err.message);
        return null;
      }
    }

    function renderLeadDetails(lead) {
      if (!lead) {
        document.body.innerHTML = '<p class="text-red-600 font-bold text-center mt-10">Lead not found.</p>';
        return;
      }
      document.getElementById('firstName').textContent = lead.firstName;
      document.getElementById('lastName').textContent = lead.lastName;
      document.getElementById('email').textContent = lead.email;
      document.getElementById('phone').textContent = lead.phone;
      document.getElementById('tortType').textContent = lead.tortType;
      document.getElementById('status').textContent = lead.status;
      document.getElementById('createdAt').textContent = new Date(lead.createdAt).toLocaleString();
      document.getElementById('updatedAt').textContent = new Date(lead.updatedAt).toLocaleString();
    }

    window.onload = async () => {
      const leadId = getLeadIdFromURL();
      if (!leadId) {
        alert("No lead ID provided");
        return;
      }
      const lead = await fetchLeadById(leadId);
      renderLeadDetails(lead);
    };
  </script>

</body>
</html>
